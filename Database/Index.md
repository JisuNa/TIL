# Index

시작하기에 앞서 인덱스를 사용하는 이유를 알아보겠습니다.

```sql
explain
select *
from tb_order
where order_name = '토피넛라떼';

+----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+
| id | select_type | table    | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |
+----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | tb_order | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    6 |    16.67 | Using where |
+----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+
```

```sql
create index tb_order_idx01 on `tb_order` (order_name);

explain
select *
from tb_order
where order_name = '토피넛라떼';

+----+-------------+----------+------------+------+----------------+----------------+---------+-------+------+----------+-------+
| id | select_type | table    | partitions | type | possible_keys  | key            | key_len | ref   | rows | filtered | Extra |
+----+-------------+----------+------------+------+----------------+----------------+---------+-------+------+----------+-------+
|  1 | SIMPLE      | tb_order | NULL       | ref  | tb_order_idx01 | tb_order_idx01 | 122     | const |    1 |      100 | NULL  |
+----+-------------+----------+------------+------+----------------+----------------+---------+-------+------+----------+-------+
```

| type  | 설명                                                                                                                              |
|-------|---------------------------------------------------------------------------------------------------------------------------------|
| const | 기본 키 또는 고유키에 의한 loockup(등가비교), 조인이 아닌 가장 외부의 테이블에 접근 하는 방식, 결과는 항상 1행이다. 단 기본 키, 고유 키를 사용하고 있으므로 범위 검색으로 지정하는 경우 const가 되지 않는다. |
| ALL   | 전체 행 스캔, 테이블의 데이터 전체에 접근한다.                                                                                                     |
| ref   | 고유 키가아닌 인덱스에 대한 등가비교, 여러 개 행에 접근할 가능성이 있다.                                                                                      |
| range | 인덱스 특정 범위의 행에 접근한다                                                                                                              |                                                                                                              
| ...   | ...                                                                                                                             |

인덱스를 걸지 않았을 경우에는 Table Full Scan으로 조회를 하는 반면에, 인덱스를 걸었을 경우 ref 타입으로 인덱스를 사용하여 조회하는 것을 알 수 있습니다.

DBMS의 인덱스의 자료구조는 `SortedList`이며, 데이터 저장은 `ArrayList`를 사용합니다.

## `ArrayList` vs `SortedList`

### `ArrayList`

- 데이터 파일이 사용하는 자료구조
- 값을 저장되는 순서대로 유지

### `SortedList`

- 인덱스가 사용하는 자료 구조
- 저장되는 값을 항상 정렬된 상태로 유지
- 저장할 때마다 항상 값을 정렬해서 과정이 복잡하고 느림
- 정렬되어 있어 아주 빨리 원하는 값을 찾을 수 있음
- 인덱스가 많은 테이블은 `INSERT`, `UPDATE`, `DELETE`가 느리지만 `SELECT`는 빠름

## B-Tree

- Balanced Tree로 좌우 균형을 맞춘 트리
- 검색/삽입/삭제 모두 O(logN)


